(this["webpackJsonpdag-grapph-tsc"]=this["webpackJsonpdag-grapph-tsc"]||[]).push([[0],{34:function(e,n,t){"use strict";t.r(n);var r,o,i=t(2),a=t.n(i),c=t(19),s=t.n(c),u=t(23),l=t(12),d=t(6),f=t(5),g=f.c.div(r||(r=Object(d.a)(["\n  .switch {\n    position: relative;\n    display: inline-block;\n    width: 4rem;\n    height: 1.5rem;\n  }\n\n  .switch input {\n    opacity: 0;\n    width: 0;\n    height: 0;\n  }\n\n  .slider {\n    position: absolute;\n    cursor: pointer;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: ",";\n    -webkit-transition: 0.2s;\n    transition: 0.2s;\n    box-shadow: 0 0 2px ",";\n  }\n\n  .slider:before {\n    position: absolute;\n    content: '';\n    height: 14px;\n    width: 14px;\n    left: 7px;\n    bottom: 5px;\n    background-color: ",";\n    -webkit-transition: 0.2s;\n    transition: 0.2s;\n  }\n\n  input:checked + .slider {\n    background-color: ",";\n  }\n\n  input:checked + .slider:before {\n    -webkit-transform: translateY(35px);\n    -ms-transform: translateX(35px);\n    transform: translateX(35px);\n  }\n\n  /* Rounded sliders */\n  .slider.round {\n    border-radius: 34px;\n  }\n\n  .slider.round:before {\n    border-radius: 50%;\n  }\n"])),(function(e){return e.theme.background}),(function(e){return e.theme.text}),(function(e){return e.theme.background}),(function(e){return e.theme.background})),m=f.c.span(o||(o=Object(d.a)(["\n  width: 100%;\n  display: flex;\n  justify-content: space-between;\n  top: 25%;\n  align-items: center;\n\n  svg {\n    color: ",";\n    z-index: 11;\n  }\n"])),(function(e){return e.theme.text})),b=t(1);var h,v=function(e){var n=e.themeToggler;return Object(b.jsx)(g,{children:Object(b.jsxs)("label",{htmlFor:"checkbox",className:"switch",children:[Object(b.jsx)("input",{id:"checkbox",type:"checkbox",onClick:n,onChange:function(){return!1},checked:"light"===window.localStorage.getItem("theme")}),Object(b.jsx)(m,{className:"slider round",children:"light"!==window.localStorage.getItem("theme")?Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(u.a,{style:{marginLeft:"6.3px",height:"10px"}})}):Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(l.b,{size:0,style:{marginLeft:"41px",height:"10px"}})})})]})})},p=Object(f.b)(h||(h=Object(d.a)(['\n  :root {\n    //dark-mode\n    --dark-background: #1A1B27;\n    --dark-text: #F5F5F7;\n    --dark-button: rgba(0, 0, 0, 0.25);\n    --dark-vertexbg: #a371f7;\n    --dark-select: rgba(0, 0, 0, 0.25);\n    --dark-option: rgba(0, 0, 0, 0.9);\n\n    //light-mode\n    --light-background: #E7EAED; //#f2f2f2;\n    --light-text: #2E0509;\n    --light-button: rgba( 7,  89, 133, 0.35 ); //#007aff;\n    --light-vertexbg: #007aff;\n    --light-select: rgba( 7,  89, 133, 0.35 );\n    --light-option: rgba( 7,  89, 133, 0.9 ); //rgba(255, 255, 255, 0.9);\n  }\n\n  * {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n    outline: 0;\n  }\n\n  html body {\n    -webkit-font-smoothing: antialiased;\n    font-family: -apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;\n    font-weight: 500;\n    height: 100vh;\n    width: 85vw;\n    margin: 0 auto;\n    background-color: ',";\n  }\n\n  .toggler {\n    position: absolute;\n    right: 1rem;\n    top: 1rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n\n    h1 {\n      font-size: 1.5rem; //3.375rem;\n      color: ","\n    }\n\n    & > a svg {\n      color: ",";\n    }\n  }\n\n  .instructions {\n    padding: 1rem 0 1rem 0;\n    color: ","\n  }\n\n  .graph-wrapper {\n    position: relative;\n    height: 85vh;\n    border: solid 1px black;\n    border-radius: 15px;\n\n    svg{\n      position: absolute;\n      height: 100%; // temp\n      width: 100%;\n    \n      marker#arrowhead {\n        fill: ","\n      }\n\n      & g {\n        stroke: ","\n      }\n    }\n  }\n"])),(function(e){return e.theme.background}),(function(e){return e.theme.text}),(function(e){return e.theme.text}),(function(e){return e.theme.text}),(function(e){return e.theme.text}),(function(e){return e.theme.text})),x=Object(f.d)(p),j={background:"var(--dark-background)",text:"var(--dark-text)",button:"var(--dark-button)",vertexbg:"var(--dark-vertexbg)",select:"var(--dark-select)",option:"var(--dark-option)"},O={background:"var(--light-background)",text:"var(--light-text)",button:"var(--light-button)",vertexbg:"var(--light-vertexbg)",select:"var(--light-select)",option:"var(--light-option)"},y=function(e){var n=e.theme,t=e.children,r="dark"===n?j:O;return Object(b.jsx)(f.a,{theme:r,children:t})},w=t(3),k=a.a.createContext([{},function(){}]),S=function(e){var n=Object(i.useState)({}),t=Object(w.a)(n,2),r=t[0],o=t[1];return Object(b.jsx)(k.Provider,{value:[r,o],children:e.children})},C=t(8),E=t(7),N=t(9),P=t(10),D=t(25),T=t(11),L=t(26),R=t(24),M=function(e){Object(L.a)(t,e);var n=Object(R.a)(t);function t(){var e;return Object(N.a)(this,t),(e=n.call(this)).rank=void 0,e.topSorted=void 0,e.rank={},e.topSorted=[],e}return Object(P.a)(t,[{key:"topologySortCaller",value:function(){var e=[];return Object(D.a)(Object(T.a)(t.prototype),"topsort",this).call(this,(function(n,t){e.push(n.name)})),this.topSorted=e,e}},{key:"visit_giveRank",value:function(){var e=this,n=Object(E.a)(this.topSorted).reverse(),t=0;n.forEach((function(r,o){var i=Object(E.a)(e.vertices[r].incomingNames),a=n[o+1];if(i.includes(a))return i.includes(a)?(e.rank[r]=t,void(t+=1)):void 0;e.rank[r]=t}))}},{key:"deleteFromIncomingArr",value:function(e,n){n.incomingNames=n.incomingNames.filter((function(n){return n!==e}))}},{key:"deleteFromIncoming",value:function(e,n){delete n.incoming[e]}},{key:"getOutgoingMap",value:function(){for(var e={},n=0,t=Object.entries(this.vertices);n<t.length;n++){var r,o=Object(w.a)(t[n],2),i=o[0],a=o[1],c=Object(C.a)(a.incomingNames);try{for(c.s();!(r=c.n()).done;){var s=r.value;if(void 0!==e[s]){if(e[s].includes(i))continue;e[s].push(i)}else void 0===e[s]&&(e[s]=[i])}}catch(u){c.e(u)}finally{c.f()}}return e}},{key:"giveRank",value:function(){this.topSorted.length!==this.names.length&&this.topologySortCaller(),this.rank={},this.visit_giveRank()}},{key:"delete",value:function(e){for(var n=this.getOutgoingMap(),t=0,r=Object.entries(n);t<r.length;t++){var o=Object(w.a)(r[t],2),i=o[0],a=o[1];a.includes(e)&&1===a.length&&(this.vertices[i].hasOutgoing=!1)}for(var c=0,s=Object.entries(this.vertices);c<s.length;c++){var u=Object(w.a)(s[c],2),l=(u[0],u[1]);this.deleteFromIncomingArr(e,l),this.deleteFromIncoming(e,l)}delete this.vertices[e],this.names=this.names.filter((function(n){return n!==e})),this.giveRank()}},{key:"changeName",value:function(){}}]),t}(function(){function e(){Object(N.a)(this,e),this.names=void 0,this.vertices=void 0,this.names=[],this.vertices={}}return Object(P.a)(e,[{key:"add",value:function(e){if(this.vertices.hasOwnProperty(e))return this.vertices[e];var n={name:e,incoming:{},incomingNames:[],hasOutgoing:!1,value:null};return this.vertices[e]=n,this.names.push(e),n}},{key:"map",value:function(e,n){this.add(e).value=n}},{key:"visit",value:function(e,n,t,r){var o=[e.name,e.incoming,e.incomingNames],i=o[0],a=o[1],c=o[2];if(t||(t={}),r||(r=[]),!t.hasOwnProperty(i)){r.push(i),t[i]=!0;var s,u=Object(C.a)(c);try{for(u.s();!(s=u.n()).done;){var l=s.value;this.visit(a[l],n,t,r)}}catch(d){u.e(d)}finally{u.f()}n(e,r),r.pop()}}},{key:"addEdge",value:function(e,n){if(e&&n&&e!==n){var t=this.add(e),r=this.add(n);if(!r.incoming.hasOwnProperty(e)){this.visit(t,(function(e,t){if(e.name===n)throw new Error("cycle detected: "+n+" <- "+t.join(" <- "))})),t.hasOutgoing=!0,r.incoming[e]=t,r.incomingNames.push(e)}}}},{key:"addEdges",value:function(e,n,t,r){var o=this;this.map(e,n),t&&("string"===typeof t&&this.addEdge(e,t),Array.isArray(t)&&t.forEach((function(n){o.addEdge(e,n)}))),r&&("string"===typeof r&&this.addEdge(r,e),Array.isArray(r)&&r.forEach((function(n){o.addEdge(n,e)})))}},{key:"topsort",value:function(e){var n,t={},r=[this.vertices,this.names],o=r[0],i=r[1],a=Object(C.a)(i);try{for(a.s();!(n=a.n()).done;){var c=o[n.value];c.hasOutgoing||this.visit(c,e,t)}}catch(s){a.e(s)}finally{a.f()}}}]),e}());function F(e){return e.split(/[\s,]+/)}function A(e){var n=[];return e.forEach((function(e,t){n[t]=e.trim()})),n}var X=a.a.createContext([{},{},!1,function(){}]),I=function(e){var n=e.setlocalStorage,t=e.children,r=Object(i.useState)(!1),o=Object(w.a)(r,2),a=o[0],c=o[1],s=Object(i.useState)(new M),u=Object(w.a)(s,2),l=u[0],d=u[1],f={createVertex:function(e){if(!e.vertex)return alert("Vertex Name must not be empty"),!1;var n=function(e){var n=e.incomming,t=e.vertex,r=e.outgoing,o=[F(n.trim()),F(r.trim())],i=o[1];return{incomming:A(o[0]),vertex:t.trim(),outgoing:A(i)}}(e),t=n.incomming,r=n.vertex,o=n.outgoing,i=l.vertices[r]?l.vertices[r].value:null;try{l.addEdges(r,i,o,t),l.giveRank()}catch(s){return alert(s),!1}return c(!a),g(l),!0},deleteVertex:function(e){if(!l.names.includes(e))return void alert("Tag >>> ".concat(e," <<< not exist !"));l.delete(e),c(!a),g(l)},appendVertexValue:function(e,n){l.map(e,n),c(!a),g(l)},resetDag:function(){n(""),c(!a),d((function(){return new M}))}},g=function(e){var t={};e.names.forEach((function(n){var r;t[n]={rank:e.rank[n],value:null!==(r=e.vertices[n].value)&&void 0!==r?r:null,incomingNames:e.vertices[n].incomingNames}}));var r=JSON.stringify(t);n(r)};return Object(i.useEffect)((function(){!function(){var e=window.localStorage.getItem("dagData");if(null!==e&&"null"!==e&&""!==e){for(var n=JSON.parse(e),t=function(){var e=Object(w.a)(o[r],2),t=e[0],i=e[1];l.map(t,n[t].value),i.incomingNames.forEach((function(e){l.addEdge(e,t)}))},r=0,o=Object.entries(n);r<o.length;r++)t();l.giveRank(),c(!a)}}()}),[]),Object(b.jsx)(X.Provider,{value:[l,f,a,c],children:t})};function Y(e){if(!e.topSorted)throw new Error("dag has no topSorted yet, dag.topSorted might be undefined ");var n=Object(E.a)(e.topSorted),t=0,r={};return n.reverse().forEach((function(n,o){e.vertices[n].incomingNames.forEach((function(e,o){r[t]={name:n,incommingName:e},t+=1}))})),[r,t]}var H=function(){function e(n){Object(N.a)(this,e),this.ele=void 0,this.command=void 0,this.ele=n,this.command=this.ele.getAttribute("d")}return Object(P.a)(e,[{key:"mount",value:function(e){this.ele.setAttribute("d",e)}}]),e}(),V=function(){function e(n){Object(N.a)(this,e),this.from=void 0,this.to=void 0,this.from=n.from,this.to=n.to}return Object(P.a)(e,[{key:"getPosnLeftEnds",value:function(){var e={x:this.from.offsetLeft-8,y:this.from.offsetTop+this.from.offsetHeight/2+10},n={x:this.to.offsetLeft-8,y:this.to.offsetTop+this.to.offsetHeight/2-10};return e.x+=B(this.from).number.x,e.y+=B(this.from).number.y,n.x+=B(this.to).number.x,n.y+=B(this.to).number.y,[e,n]}},{key:"getPosnTopButtonEnds",value:function(){var e={x:this.from.offsetLeft+this.from.offsetWidth/2,y:this.from.offsetTop+this.from.offsetHeight+8},n={x:this.from.offsetLeft+this.from.offsetWidth/2,y:this.from.offsetTop-8};return e.x+=B(this.from).number.x,e.y+=B(this.from).number.y,n.x+=B(this.to).number.x,n.y+=B(this.to).number.y,[e,n]}},{key:"getStraitCommand",value:function(){var e=this.getPosnTopButtonEnds(),n=Object(w.a)(e,2);return z({moveFrom:n[0],LineTo:n[1]})}},{key:"getCurveCommand",value:function(){var e=this.getPosnLeftEnds(),n=Object(w.a)(e,2),t=n[0],r=n[1];return U({moveFrom:t,controlPoint1:{x:t.x-100,y:t.y},controlPoint2:{x:r.x-100,y:r.y},moveTo:r})}}]),e}();function U(e){var n=e.moveFrom,t=e.controlPoint1,r=e.controlPoint2,o=e.moveTo;return"M".concat(n.x,",").concat(n.y," ")+"C".concat(t.x,",").concat(t.y," ")+"".concat(r.x,",").concat(r.y," ")+"".concat(o.x,",").concat(o.y)}function z(e){var n=e.moveFrom,t=e.LineTo;return"M".concat(n.x,",").concat(n.y," ")+"L".concat(t.x,",").concat(t.y)}function B(e){var n=e.style.transform.split(" ").map((function(e){return+e.replace(/[^\d]/g,"")}));return{percentage:{x:n[0],y:n[1]},number:{x:n[2],y:n[3]}}}function _(e){var n={};return{drawConnectorDynamic:function(t,r,o){t.forEach((function(t,i){var a,c=t.current;if((null===c||void 0===c?void 0:c.getAttribute("data-vertex_from"))===r)a="FROM";else{if((null===c||void 0===c?void 0:c.getAttribute("data-vertex_to"))!==r)throw new Error("SVGPathElemet missing attrivute data-vertex_from and data-vertex_to");a="TO"}var s=new H(c);if(!s.command)throw new Error("path.command not found");if(n[c.id]||(n[c.id]=s.command),n[c.id]){var u="";"CURVE"===e?u=function(e,n,t){var r=e.split(/[\s|,]/g);r[0]=r[0].replace("M",""),r[2]=r[2].replace("C","");var o={moveFrom:{x:+r[0],y:+r[1]},controlPoint1:{x:+r[2],y:+r[3]},controlPoint2:{x:+r[4],y:+r[5]},moveTo:{x:+r[6],y:+r[7]}};if("FROM"===n)o.moveFrom.x+=t.x,o.moveFrom.y+=t.y,o.controlPoint1.x+=t.x,o.controlPoint1.y+=t.y;else{if("TO"!==n)throw new Error("Wrong indicaotr format");o.controlPoint2.x+=t.x,o.controlPoint2.y+=t.y,o.moveTo.x+=t.x,o.moveTo.y+=t.y}return U(o)}(n[c.id],a,o):"STRAIGHT"===e&&(u=function(e,n,t){var r=e.split(/[\s|,]/g);r[0]=r[0].replace("M",""),r[2]=r[2].replace("L","");var o={moveFrom:{x:+r[0],y:+r[1]},LineTo:{x:+r[2],y:+r[3]}};if("FROM"===n)o.moveFrom.x+=t.x,o.moveFrom.y+=t.y;else{if("TO"!==n)throw new Error("Wrong indicator format");o.LineTo.x+=t.x,o.LineTo.y+=t.y}return z(o)}(n[c.id],a,o)),s.mount(u)}}))}}}function W(e){var n,t=e.incommingName,r=e.name,o=e.arrowStyleOpt,a=e.forwardedRef,c=e.forwardedDivsRef,s=Object(i.useContext)(k),u=(Object(w.a)(s,1)[0],(n=o,{drawConnectorInitial:function(e,t){var r=new H(t),o=new V(e),i="";"CURVE"===n&&(i=o.getCurveCommand()),"STRAIGHT"===n&&(i=o.getStraitCommand()),r.mount(i)}}).drawConnectorInitial);return Object(i.useEffect)((function(){var e=function(){var e,n={from:null,to:null},o=Object(C.a)(c);try{for(o.s();!(e=o.n()).done;){var i=e.value.current;(null===i||void 0===i?void 0:i.id)===t&&(n.from=i),(null===i||void 0===i?void 0:i.id)===r&&(n.to=i)}}catch(a){o.e(a)}finally{o.f()}if(null===n.from&&null===n.to)throw new Error("Cant access divs refs in Arrow.tsx");return n}();u(e,a.current)}),[c]),Object(b.jsx)("g",{fill:"none",stroke:"black",strokeWidth:"2",markerEnd:"url(#arrowhead)",children:Object(b.jsx)("path",{ref:a,id:"arrowLeft_".concat(r,"_").concat(t),"data-vertex_from":t,"data-vertex_to":r})})}function G(e){var n=e.dag,t=e.refs,r=e.arrowStyleOpt,o=Object(w.a)(t,2),i=o[0],a=o[1],c=Y(n),s=Object(w.a)(c,2),u=s[0],l=s[1];return Object(E.a)(Array(l)).map((function(e,n){return Object(b.jsx)(W,{incommingName:u[n].incommingName,name:u[n].name,arrowStyleOpt:r,forwardedRef:a.current[n],forwardedDivsRef:i.current},n)}))}var J,q=t(4),K=f.c.div(J||(J=Object(d.a)(["\n  color: ",";\n  background-color: ",";\n  text-align: center;\n  padding: 10px;\n  min-width: 100px;\n  height: auto;\n  border-radius: 15px;\n\n  position: absolute;\n  top: ",";\n  left: ",";\n\n  &:hover {\n    cursor: grab;\n  }\n\n  &.draggable-dragging {\n    cursor: grabbing;\n  }\n\n  /*\n      To Prevent user selectin inside the drag source \n      This is also covered in draggable component (duplicated)\n  */\n  user-select: none;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n\n  /*\n      vertex's name as key \n  */\n  span {\n    background-color: rgba(14, 151, 179, 0.13);\n    padding: 0 5% 0 5%;\n    position: absolute;\n    top: 3%;\n    left: 4px;\n    border: 1px solid rgba(16, 18, 27, 0.35);\n    border-radius: 15px;\n  }\n\n  /*\n      vertex's value could changed by submitting form\n  */\n  form input {\n    color: ",";\n    background-color: ",";\n    border: 0;\n    border-radius: 15px;\n    outline: 0;\n    cursor: inherit;\n    max-width: 80px;\n    font-size: 1.08rem;\n    text-align: center;\n\n    &:focus {\n      background-color: rgb(156 163 175);\n    }\n  }\n"])),(function(e){return e.theme.text}),(function(e){return e.theme.vertexbg}),(function(e){return e.posn.top}),(function(e){return e.posn.left}),(function(e){return e.theme.text}),(function(e){return e.theme.vertexbg}));function Q(e,n,t,r){var o=Object(q.a)({capture:!0},r);e.addEventListener(n,t,o)}function Z(e,n,t,r){var o=Object(q.a)({capture:!0},r);e.removeEventListener(n,t,o)}function $(e,n){return function(t){n(t,e)}}function ee(e){if(e){var n,t,r=e.getElementById("draggable-style-el");r||((r=e.createElement("style")).type="text/css",r.id="draggable-style-el",r.innerHTML=".draggable-transparent-selection *::-moz-selection {all: inherit;}\n",r.innerHTML+=".draggable-transparent-selection *::selection {all: inherit;}\n",e.getElementsByTagName("head")[0].appendChild(r)),e.body&&(n=e.body,t="draggable-transparent-selection",n.classList?n.classList.add(t):n.className.match(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)")))||(n.className+=" ".concat(t)))}}function ne(e){var n,t;if(e)try{e.body&&(n=e.body,t="draggable-transparent-selection",n.classList?n.classList.remove(t):n.className=n.className.replace(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)"),"g"),""));var r=(e.defaultView||window).getSelection();r&&"Caret"!==r.type&&r.removeAllRanges()}catch(o){}}function te(e){return"both"===e||"y"===e}function re(e,n){return function(e,n){var t=n===n.ownerDocument.body?{left:0,top:0}:n.getBoundingClientRect();return{x:e.clientX+n.scrollLeft-t.left,y:e.clientY+n.scrollTop-t.top}}(e,n.offsetParent||n.ownerDocument.body)}function oe(e,n,t,r){var o=e.lastX,i=e.lastY;return!("number"===typeof o)?{node:r,deltaX:0,deltaY:0,lastX:n,lastY:t,x:n,y:t}:{node:r,deltaX:n-o,deltaY:t-i,lastX:o,lastY:i,x:n,y:t}}function ie(e,n,t){return{node:t.node,x:e.x+t.deltaX/n,y:e.y+t.deltaY/n,deltaX:t.deltaX/n,deltaY:t.deltaY/n,lastX:e.x,lastY:e.y}}var ae={start:"mousedown",move:"mousemove",stop:"mouseup"},ce=ae;function se(e){var n,t,r,o,a,c,s,u,l=Object(q.a)(Object(q.a)({},e),{},{allowAnyClick:null!==(n=e.allowAnyClick)&&void 0!==n&&n,disabled:null!==(t=e.disabled)&&void 0!==t&&t,enableUserSelectHack:null===(r=e.enableUserSelectHack)||void 0===r||r,onStart:null!==(o=e.onStart)&&void 0!==o?o:function(){},onDrag:null!==(a=e.onDrag)&&void 0!==a?a:function(){},onStop:null!==(c=e.onStop)&&void 0!==c?c:function(){},onMouseDown:null!==(s=e.onMouseDown)&&void 0!==s?s:function(){},scale:null!==(u=e.scale)&&void 0!==u?u:1}),d=Object(i.useState)({dragging:!1,lastX:NaN,lastY:NaN}),f=Object(w.a)(d,2),g=f[0],m=f[1];function h(e,n){var t=n.ownerDocument,r=re(e,n),o=r.x,i=r.y,a=oe(g,o,i,n);l.onStart,!1!==l.onStart(e,a)&&(l.enableUserSelectHack&&ee(t),m({dragging:!0,lastX:o,lastY:i}))}function v(e){var n=l.forwardedRef.current;if(!n)throw new Error("forwarded reference of vertex is null");var t=re(e,n),r=t.x,o=t.y,i=oe(g,r,o,n);if(!1!==l.onDrag(e,i))m((function(e){return Object(q.a)(Object(q.a)({},e),{},{lastX:r,lastY:o})}));else try{p(new MouseEvent("mouseup"))}catch(c){var a=document.createEvent("MouseEvents");a.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),p(a)}}function p(e){if(g.dragging){var n=l.forwardedRef.current;if(!n)throw new Error("forwarded reference of vertex is null");var t=n.ownerDocument,r=re(e,n),o=r.x,i=r.y,a=oe(g,o,i,n);if(!1===l.onStop(e,a))return!1;l.enableUserSelectHack&&ne(t),m({dragging:!1,lastX:NaN,lastY:NaN})}}return Object(i.useEffect)((function(){var e=l.forwardedRef.current;if(!e)throw new Error("forwarded reference of vertex is null");var n=e.ownerDocument;return Q(e,ce.start,$(e,h),{passive:!1}),g.dragging&&(Q(n,ce.move,v),Q(n,ce.stop,p)),function(){Z(e,ce.start,$(e,h),{passive:!1}),Z(n,ce.move,v),Z(n,ce.stop,p),l.enableUserSelectHack&&ne(n)}}),[g.dragging]),Object(b.jsx)(b.Fragment,{children:l.children})}function ue(e){var n,t,r,o,c,s,u,l,d,f,g,m,h,v,p=Object(q.a)(Object(q.a)({},e),{},{allowAnyClick:null!==(n=e.allowAnyClick)&&void 0!==n&&n,disabled:null!==(t=e.disabled)&&void 0!==t&&t,enableUserSelectHack:null===(r=e.enableUserSelectHack)||void 0===r||r,onStart:null!==(o=e.onStart)&&void 0!==o?o:function(){},onDrag:null!==(c=e.onDrag)&&void 0!==c?c:function(){},onStop:null!==(s=e.onStop)&&void 0!==s?s:function(){},onMouseDown:null!==(u=e.onMouseDown)&&void 0!==u?u:function(){},scale:null!==(l=e.scale)&&void 0!==l?l:1,defaultClassName:void 0!==e.defaultClassName?e.defaultClassName:"draggable",defaultClassNameDragging:null!==(d=e.defaultClassNameDragging)&&void 0!==d?d:"draggable-dragging",defaultClassNameDragged:null!==(f=e.defaultClassNameDragged)&&void 0!==f?f:"draggable-dragged",defaultPosition:void 0!==e.defaultPosition?e.defaultPosition:{x:0,y:0},positionOffset:void 0!==e.positionOffset?e.positionOffset:{x:"0%",y:"0%"},position:void 0!==e.position?e.position:{x:0,y:0},axis:void 0!==e.axis?e.axis:"both"}),x=Object(i.useState)({dragging:!1,dragged:!1,x:(null===(g=e.defaultPosition)||void 0===g?void 0:g.x)||(null===(m=e.position)||void 0===m?void 0:m.x)||p.position.x,y:(null===(h=e.defaultPosition)||void 0===h?void 0:h.y)||(null===(v=e.position)||void 0===v?void 0:v.y)||p.position.y}),j=Object(w.a)(x,2),O=j[0],y=j[1];var k=!Boolean(void 0!==e.position)||O.dragging,S=e.position||e.defaultPosition;void 0===S&&(S=p.position);var C,E=function(e,n){var t=function(e,n,t){var r=e.x,o=e.y,i="translate(".concat(r).concat(t,",").concat(o).concat(t,")");if(n){var a="".concat("string"===typeof n.x?n.x:n.x+t),c="".concat("string"===typeof n.y?n.y:n.y+t);i="translate(".concat(a,", ").concat(c,") ")+i}return i}(e,n,"px");return{transform:t}}({x:(C=p.axis,"both"!==C&&"x"!==C||!k?S.x:O.x),y:te(p.axis)&&k?O.y:S.y},p.positionOffset),N=p.defaultClassName;return O.dragging&&(N+=" "+p.defaultClassNameDragging),O.dragged&&(N+=" "+p.defaultClassNameDragged),p.children.props.className&&(N+=" "+p.children.props.className),Object(b.jsx)(se,{onStart:function(e,n){if(!1===p.onStart(e,ie(O,p.scale,n)))return!1;y((function(e){return Object(q.a)(Object(q.a)({},e),{},{dragging:!0,dragged:!0})}))},onDrag:function(e,n){if(!O.dragging)return!1;var t=ie(O,p.scale,n),r={x:t.x,y:t.y};if(!1===p.onDrag(e,t))return!1;y((function(e){return Object(q.a)(Object(q.a)({},e),r)}))},onStop:function(n,t){if(O.dragging){if(!1===p.onStop(n,ie(O,p.scale,t)))return!1;var r={dragging:!1};if(Boolean(void 0!==e.position)){var o=p.position,i=o.x,a=o.y;r.x=i,r.y=a}y((function(e){return Object(q.a)(Object(q.a)({},e),r)}))}},forwardedRef:p.forwardedRef,children:a.a.cloneElement(a.a.Children.only(p.children),{className:N,style:Object(q.a)(Object(q.a)({},p.children.props.style),E)})})}function le(e,n){var t=function(){var e=a.a.useRef([]);return{appendPendingPromise:function(n){e.current=[].concat(Object(E.a)(e.current),[n])},removePendingPromise:function(n){e.current=e.current.filter((function(e){return e!==n}))},clearPendingPromise:function(){return e.current.map((function(e){return e.cancel()}))}}}();return[function(){t.clearPendingPromise();var n,r=function(e){var n=!1;return{promise:new Promise((function(t,r){e.then((function(e){return n?r({isCanceled:n,value:e}):t(e)}),(function(e){return r({isCanceled:n,error:e})}))})),cancel:function(){return n=!0}}}((n=300,new Promise((function(e){return setTimeout(e,n)}))));return t.appendPendingPromise(r),r.promise.then((function(){t.removePendingPromise(r),e()})).catch((function(e){if(t.removePendingPromise(r),!e.isCanceled)throw e.error}))},function(){t.clearPendingPromise(),n()}]}var de,fe=function(e){var n,t=e.initName,r=e.children,o=Object(i.useContext)(X),a=Object(w.a)(o,2),c=a[0],s=a[1],u=Object(i.useState)(null!==(n=c.vertices[t].value)&&void 0!==n?n:t),l=Object(w.a)(u,2),d=l[0],f=l[1],g=Object(i.useRef)(null),m=le((function(){}),(function(){g.current&&(g.current.focus(),g.current.setSelectionRange(0,d.length))})),h=Object(w.a)(m,2),v=h[0],p=h[1];return Object(b.jsxs)("div",{style:{height:"100%",width:"100%"},onClick:v,onDoubleClick:p,children:[Object(b.jsx)("form",{onSubmit:function(e){e.preventDefault(),s.appendVertexValue(t,d),g.current&&g.current.blur()},children:Object(b.jsx)("input",{ref:g,type:"text",value:d,onChange:function(e){f(e.target.value)},onMouseDown:function(e){return function(e){e.preventDefault()}(e)}})}),r]})};function ge(e){var n=e.name,t=e.arrowStyleOpt,r=e.location,o=e.forwardedRef,a=e.forwardedArrowsRefs,c=Object(w.a)(r,2),s=150+150*c[0],u=150*c[1],l=Object(i.useState)({activeDrags:0,deltaPosition:{x:0,y:0},controlledPosition:{x:-400,y:200}}),d=Object(w.a)(l,2),f=d[0],g=d[1],m=_(t).drawConnectorDynamic,h=function(e,n){return e.filter((function(e){if(e.current){var t=e.current;return t&&(t.getAttribute("data-vertex_from")===n||t.getAttribute("data-vertex_to")===n)}}))}(a,n),v={onStart:function(){return g((function(e){return Object(q.a)(Object(q.a)({},e),{},{activeDrags:f.activeDrags+1})}))},onStop:function(){return g((function(e){return Object(q.a)(Object(q.a)({},e),{},{activeDrags:f.activeDrags-1})}))}};return Object(i.useEffect)((function(){})),Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(ue,Object(q.a)(Object(q.a)({},v),{},{onDrag:function(e,t){var r=f.deltaPosition,o=r.x,i=r.y;g((function(e){return Object(q.a)(Object(q.a)({},e),{},{deltaPosition:{x:o+t.deltaX,y:i+t.deltaY}})})),m(h,n,{x:t.deltaX,y:t.deltaY})},forwardedRef:o,positionOffset:{x:"0%",y:"0%"},defaultPosition:{x:u,y:s},defaultClassName:"draggable-".concat(n),children:Object(b.jsx)(K,{posn:{position:"absolute"},ref:o,id:n,children:Object(b.jsx)(fe,{initName:n,children:Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("span",{children:[" ",n," "]}),Object(b.jsx)("br",{})]})})})}))})}function me(e){var n=e.dag,t=e.refs,r=e.arrowStyleOpt,o=[n.rank,n.topSorted],i=o[0],a=o[1];if(i&&a){var c=i["".concat(a[0])],s={},u=Object(w.a)(t,2),l=u[0],d=u[1];return a.map((function(e,n){var t=c-i[e];s[t]=s[t]+1||1;var o=s[t];return Object(b.jsx)(ge,{name:e,arrowStyleOpt:r,location:[t,o],forwardedRef:l.current[n],forwardedArrowsRefs:d.current},e)}))}}var be=f.c.div(de||(de=Object(d.a)(["\n  color: ",";\n  border: solid;\n  border-radius: 5px;\n  height: ",";\n  width: 8rem;\n  position: absolute;\n  left: 1rem;\n  bottom: 1rem;\n  /* glassmorphism */\n  background: ",";\n  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);\n  backdrop-filter: blur(4px);\n  border-radius: 10px;\n  border: 1px solid rgba(255, 255, 255, 0.18);\n\n  &:hover {\n    cursor: pointer;\n  }\n\n  p {\n    padding: 1.3rem;\n  }\n\n  .options {\n    position: absolute;\n    top: -",";\n    height: ",";\n\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n\n    div {\n      background-color: ",";\n      /* glassmorphism */\n      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);\n      backdrop-filter: blur(4px);\n      border-radius: 10px;\n      border: 1px solid rgba(255, 255, 255, 0.18);\n      margin: 0.5rem;\n\n      &:hover {\n        transform: translate(-0.2rem, -0.2rem);\n      }\n\n      &.option-mouse-down {\n        transform: scale(0.95);\n      }\n\n      /* TODO: svg path not align with viewpoint */\n      svg {\n        marker#arrowhead {\n          fill: ",";\n        }\n\n        & g {\n          stroke: ",";\n        }\n      }\n    }\n  }\n\n  .collapseAria {\n    transform: translateX(-2rem);\n    width: 0;\n    opacity: 0;\n    transition-property: width, opacity, transform;\n    transition-duration: 0.5s, 0.5s, 0.5s;\n    transition-timing-function: linear, ease-out, linear;\n  }\n\n  .expandAria {\n    transform: translateX(0);\n    width: 25vw;\n    opacity: 1;\n    transition-property: width, opacity, transform;\n    transition-duration: 0.5s, 1s, 0.5s;\n    transition-timing-function: linear, ease-in, linear;\n  }\n"])),(function(e){return e.theme.text}),"4rem",(function(e){return e.theme.select}),"10rem","10rem",(function(e){return e.theme.option}),(function(e){return e.theme.text}),(function(e){return e.theme.text}));var he,ve=function(e){e.styleOpt;var n=e.setStyleOpt,t=Object(i.useState)(!1),r=Object(w.a)(t,2),o=r[0],a=r[1],c=function(e){e.currentTarget.classList.add("option-mouse-down")},s=function(e){var n=e.currentTarget;n.classList.contains("option-mouse-down")&&n.classList.remove("option-mouse-down")};return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)(be,{onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)},children:[Object(b.jsx)("p",{children:" Arrow style "}),Object(b.jsxs)("div",{className:"options ".concat(o?"expandAria":"collapseAria"),"data-aria-expend":o,children:[Object(b.jsx)("div",{onClick:function(){return n("CURVE")},onMouseDown:function(e){return c(e)},onMouseUp:function(e){return s(e)},children:Object(b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",children:[Object(b.jsx)("defs",{children:Object(b.jsx)("marker",{id:"arrowhead",viewBox:"0 0 10 10",refX:"3",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto",children:Object(b.jsx)("path",{d:"M 0 0 L 10 5 L 0 10 z"})})}),Object(b.jsx)("g",{fill:"none",stroke:"black",strokeWidth:"2",markerEnd:"url(#arrowhead)",children:Object(b.jsx)("path",{d:"M80,20 C15,20 15,120 80,120"})})]})}),Object(b.jsx)("div",{onClick:function(){return n("STRAIGHT")},onMouseDown:function(e){return c(e)},onMouseUp:function(e){return s(e)},children:Object(b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",children:[Object(b.jsx)("defs",{children:Object(b.jsx)("marker",{id:"arrowhead",viewBox:"0 0 10 10",refX:"3",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto",children:Object(b.jsx)("path",{d:"M 0 0 L 10 5 L 0 10 z"})})}),Object(b.jsx)("g",{fill:"none",stroke:"black",strokeWidth:"2",markerEnd:"url(#arrowhead)",children:Object(b.jsx)("path",{d:"M65,20 65,115"})})]})})]})]})})};function pe(e){var n=e.dag,t=e.topSorted,r=Object(i.useContext)(k),o=Object(w.a)(r,2),c=(o[0],o[1],Y(n)),s=Object(w.a)(c,2),u=(s[0],s[1]),l=Object(i.useRef)([]),d=Object(i.useRef)([]);l.current=Object(E.a)(new Array(t.length)).map((function(){return a.a.createRef()})),d.current=Object(E.a)(new Array(u)).map((function(){return a.a.createRef()}));var f=Object(i.useState)("CURVE"),g=Object(w.a)(f,2),m=g[0],h=g[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("p",{className:"instructions",children:["Drag items",Object(b.jsx)("br",{}),"Double click items to change title / name"]}),Object(b.jsxs)("div",{className:"graph-wrapper",children:[Object(b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",children:[Object(b.jsx)("defs",{children:Object(b.jsx)("marker",{id:"arrowhead",viewBox:"0 0 10 10",refX:"3",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto",children:Object(b.jsx)("path",{d:"M 0 0 L 10 5 L 0 10 z"})})}),G({dag:n,refs:[l,d],arrowStyleOpt:m})]}),me({dag:n,refs:[l,d],arrowStyleOpt:m})]}),Object(b.jsx)(ve,{styleOpt:m,setStyleOpt:h})]})}var xe=f.c.form(he||(he=Object(d.a)(["\n  width: 8rem;\n  position: absolute;\n  right: 300px;\n  bottom: 2rem;\n\n  label {\n    color: ",";\n  }\n\n  input {\n    color: ",";\n    width: 8rem;\n    height: 1.5rem;\n    font-size: 1.08rem;\n    text-align: center;\n\n    /* glassmorphism */\n    background: ",";\n    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);\n    backdrop-filter: blur(4px);\n    border-radius: 4px;\n    border: 1px solid rgba(255, 255, 255, 0.18);\n\n    &::placeholder {\n      color: ",";\n      opacity: 0.5;\n    }\n  }\n"])),(function(e){return e.theme.text}),(function(e){return e.theme.text}),(function(e){return e.theme.select}),(function(e){return e.theme.text}));var je,Oe,ye,we,ke,Se=function(e){var n=e.deleteVertex,t=Object(i.useState)(""),r=Object(w.a)(t,2),o=r[0],a=r[1];return Object(b.jsxs)(xe,{onSubmit:function(e){e.preventDefault(),n(o),a("")},children:[Object(b.jsx)("label",{children:" Delete by tag : "}),Object(b.jsx)("input",{name:"vertex",value:o,placeholder:"\ud83d\udc49 a",onChange:function(e){a(e.target.value)}})]})},Ce=f.c.div(je||(je=Object(d.a)(["\n  position: fixed;\n  right: 2rem;\n  bottom: 2rem;\n  padding: 1.5rem;\n\n  /* glassmorphism */\n  background: ",";\n  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);\n  backdrop-filter: blur(8px);\n  border-radius: 4px;\n  border: 1px solid rgba(255, 255, 255, 0.18);\n"])),(function(e){return e.theme.select})),Ee=f.c.form(Oe||(Oe=Object(d.a)(["\n  display: flex;\n  flex-direction: column;\n  color: ",";\n\n  label {\n    width: 10rem;\n  }\n\n  input {\n    color: ",";\n    width: 10rem;\n    height: 1.5rem;\n    font-size: 1.08rem;\n    text-align: center;\n    margin: 0 0 1rem 0;\n\n    /* glassmorphism -- upper layer*/\n    background: ",";\n    border-radius: 4px;\n    border: 1px solid rgba(255, 255, 255, 0.18);\n\n    &::placeholder {\n      color: ",";\n      opacity: 0.5;\n    }\n  }\n"])),(function(e){return e.theme.text}),(function(e){return e.theme.text}),(function(e){return e.theme.select}),(function(e){return e.theme.text})),Ne=f.c.button(ye||(ye=Object(d.a)(["\n  margin-top: 0.5rem;\n  padding: 5px 0 5px 0;\n  font-size: 1.3rem;\n  width: 10rem;\n\n  /* glassmorphism -- upper layer*/\n  background: ",";\n  border-radius: 4px;\n  border: 1px solid rgba(255, 255, 255, 0.18);\n\n  color: ",";\n\n  &.btn-mouse-down {\n    transform: scale(0.95);\n  }\n"])),(function(e){return e.theme.button}),(function(e){return e.theme.text}));function Pe(e){var n=e.createVertex,t=Object(i.useState)(""),r=Object(w.a)(t,2),o=r[0],a=r[1],c=Object(i.useState)(""),s=Object(w.a)(c,2),u=s[0],l=s[1],d=Object(i.useState)(""),f=Object(w.a)(d,2),g=f[0],m=f[1];return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(Ce,{children:Object(b.jsxs)(Ee,{onSubmit:function(e){e.preventDefault(),n({vertex:o,incomming:u,outgoing:g})&&(a(""),l(""),m(""))},children:[Object(b.jsx)("label",{children:"Incomming Note Tag"}),Object(b.jsx)("input",{name:"incomming",placeholder:"\ud83d\udc49 a, b, c ...",value:u,onChange:function(e){l(e.target.value)}}),Object(b.jsx)("label",{children:"Tag Name"}),Object(b.jsx)("input",{name:"vertex",value:o,placeholder:"\ud83d\udc49 d (must)",onChange:function(e){a(e.target.value)}}),Object(b.jsx)("label",{children:"Outgoing Note Tag"}),Object(b.jsx)("input",{name:"outgoing",value:g,placeholder:"\ud83d\udc49 e, f, g ...",onChange:function(e){m(e.target.value)}}),Object(b.jsx)(Ne,{onMouseDown:function(e){return function(e){e.currentTarget.classList.add("btn-mouse-down")}(e)},onMouseUp:function(e){return function(e){var n=e.currentTarget;n.classList.contains("btn-mouse-down")&&n.classList.remove("btn-mouse-down")}(e)},children:"Create !"})]})})})}var De=f.c.span(we||(we=Object(d.a)(["\n  position: absolute;\n  right: 450px;\n  bottom: 2rem;\n  width: auto;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  cursor: pointer;\n  opacity: 0.7;\n\n  &.clicked {\n    transform: translate(2px, 2px);\n    transition: all 0.1s linear;\n    opacity: 1;\n  }\n\n  svg {\n    color: ",";\n  }\n"])),(function(e){return e.theme.text})),Te=f.c.div(ke||(ke=Object(d.a)(["\n  position: absolute;\n  right: 50rem;\n  bottom: 10rem;\n  color: ",";\n  & > div {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    position: absolute;\n    width: 30rem;\n    opacity: ",";\n    border: solid 1px;\n    border-radius: 12px;\n    padding: 12px 0 12px 0;\n\n    /*\n      To Prevent user selectin inside the drag source\n      */\n    user-select: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n  }\n"])),(function(e){return e.theme.text}),(function(e){return e.show?"1":"0"}));var Le=function(e){var n=e.reset,t=Object(i.useState)(!1),r=Object(w.a)(t,2),o=r[0],a=r[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(De,{onMouseDown:function(e){return function(e){e.currentTarget.classList.add("clicked")}(e)},onMouseUp:function(e){return function(e){var t=e.currentTarget;t.classList.contains("clicked")&&t.classList.remove("clicked"),n()}(e)},onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)},children:Object(b.jsx)(l.c,{size:2,style:{height:"45px",width:"45px"}})}),Object(b.jsx)(Te,{show:o,children:Object(b.jsx)("div",{children:o?Object(b.jsxs)("div",{children:["We use local storage to keep data between sessions.",Object(b.jsx)("br",{})," Click me to delete all storage before creating new graph !"]}):null})})]})};var Re=function(){var e=Object(i.useContext)(X),n=Object(w.a)(e,2),t=n[0],r=n[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(pe,{dag:t,topSorted:t.topSorted}),Object(b.jsx)(Pe,{createVertex:r.createVertex}),Object(b.jsx)(Se,{deleteVertex:r.deleteVertex}),Object(b.jsx)(Le,{reset:r.resetDag})]})};var Me=function(){var e=function(){var e=Object(i.useState)("dark"),n=Object(w.a)(e,2),t=n[0],r=n[1],o=function(e){window.localStorage.setItem("theme",e),r(e)};return Object(i.useEffect)((function(){var e=window.localStorage.getItem("theme");e&&r(e)}),[]),{theme:t,themeToggler:function(){return o("dark"===t?"light":"dark")}}}(),n=e.theme,t=e.themeToggler,r=function(){var e=Object(i.useState)(""),n=Object(w.a)(e,2),t=n[0],r=n[1];return Object(i.useEffect)((function(){var e=window.localStorage.getItem("dagData");e&&r(e)})),{dagStorage:t,setlocalStorage:function(e){window.localStorage.setItem("dagData",e),r(e)}}}(),o=(r.dagStorage,r.setlocalStorage);return Object(b.jsxs)(y,{theme:n,children:[Object(b.jsx)(x,{}),Object(b.jsxs)("div",{className:"toggler",children:[Object(b.jsx)(v,{themeToggler:t}),Object(b.jsx)("div",{children:Object(b.jsx)("h1",{children:n})}),Object(b.jsx)("a",{title:"repo URL",href:"https://github.com/benson00077/dag_graph-ts",rel:"noopener noreferrer",target:"_blank",children:Object(b.jsx)(l.a,{style:{height:"25px",width:"25px",opacity:"0.5"}})})]}),Object(b.jsx)(I,{setlocalStorage:o,children:Object(b.jsx)(S,{children:Object(b.jsx)(Re,{})})})]})},Fe=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,35)).then((function(n){var t=n.getCLS,r=n.getFID,o=n.getFCP,i=n.getLCP,a=n.getTTFB;t(e),r(e),o(e),i(e),a(e)}))};s.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(Me,{})}),document.getElementById("root")),Fe()}},[[34,1,2]]]);
//# sourceMappingURL=main.8a496ce8.chunk.js.map